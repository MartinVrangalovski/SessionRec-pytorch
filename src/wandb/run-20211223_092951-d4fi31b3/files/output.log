sh: nvidia-smi: command not found
Using backend: pytorch
Namespace(batch_size=512, dataset_dir='../../datasets/diginetica', embedding_dim=256, epochs=30, extra=True, feat_drop=0.1, fusion=True, log_interval=100, lr=0.001, norm=True, num_layers=1, num_workers=4, order=3, patience=3, reducer='mean', valid_split=None, weight_decay=1e-05)
reading dataset
716835
60194
start training
Traceback (most recent call last):
  File "scripts/main_msgifsr_tune.py", line 203, in <module>
    mrr, hit = runner.train(args.epochs, args.log_interval)
  File "/Users/gjyan/Documents/Projects/lessr/SessionRec-pytorch/src/../src/utils/train.py", line 91, in train
    mrr, hit = evaluate(self.model, self.test_loader, self.device)
  File "/Users/gjyan/Documents/Projects/lessr/SessionRec-pytorch/src/../src/utils/train.py", line 43, in evaluate
    for batch in data_loader:
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 359, in __iter__
    return self._get_iterator()
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 305, in _get_iterator
    return _MultiProcessingDataLoaderIter(self)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 918, in __init__
    w.start()
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/process.py", line 121, in start
    self._popen = self._Popen(self)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/context.py", line 224, in _Popen
    return _default_context.get_context().Process._Popen(process_obj)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/context.py", line 284, in _Popen
    return Popen(process_obj)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/popen_spawn_posix.py", line 32, in __init__
    super().__init__(process_obj)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/popen_fork.py", line 19, in __init__
    self._launch(process_obj)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/popen_spawn_posix.py", line 47, in _launch
    reduction.dump(process_obj, fp)
  File "/Users/gjyan/anaconda3/envs/SHG/lib/python3.8/multiprocessing/reduction.py", line 60, in dump
    ForkingPickler(file, protocol).dump(obj)
AttributeError: Can't pickle local object 'collate_fn_factory_ccs.<locals>.collate_fn'